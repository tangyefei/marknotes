<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>

  <script>
    /**
     * @param {character[][]} board
     * @return {void} Do not return anything, modify board in-place instead.
     */
    var solve = function(board) {
      if(!board || board.length == 0 || board[0] == undefined || board[0].length == 0) return board;

      let w = board.length;
      let h = board[0].length;
      let dirs = [[-1,0],[1,0],[0,-1],[0,1]];

      let isOnBoard = function(i, j) {
        return (i == 0 || j == 0 || i == w - 1 ||  j == h - 1);
      }
      let isBigOAtBorder = function(i, j) {
        return board[i][j] === 'O' && isOnBoard(i,j);
      }

      let recurseFlapped = function(i,j) {
        if(isBigOAtBorder(i, j)) return false;

        if(board[i][j] === 'O') {
          board[i][j] = 'X';


          // if(i==2 && j == 3) {
          //   debugger;
          // }

          let flapped1 = recurseFlapped(i+dirs[0][0], j+dirs[0][1]);
          let flapped2 = recurseFlapped(i+dirs[1][0], j+dirs[1][1]);
          let flapped3 = recurseFlapped(i+dirs[2][0], j+dirs[2][1]);
          let flapped4 = recurseFlapped(i+dirs[3][0], j+dirs[3][1]);
          
          // console.log(i +',' + j + ' 上下左右的融通情况为：' + flapped1 + ',' + flapped2 + ',' + flapped3 + ',' + flapped4);
          
          // if(i==2 && j == 3) {
          //   debugger;
          // }

          let result = (flapped1 && flapped2 && flapped3 && flapped4);
          // if(i==1 && j == 1) {
          //   debugger;
          // }
          if(false == result) {
            board[i][j] = 'O';
          }
          return result;
        }

        return true;
      }

      for (let i = 0; i < w; i++) {
        for (let j = 0; j < h; j++) {
          console.log(i + ',' + j + ':' + recurseFlapped(i, j));
        } 
      }
      return board;
    };

    // var input = [
    //   ["X","X","X","X"],
    //   ["X","O","O","X"],
    //   ["X","X","O","X"],
    //   ["X","O","X","X"],
    // ];


    var input = [
      ["O","X","X","O","X"],
      ["X","O","O","X","O"],
      ["X","O","X","O","X"],
      ["O","X","O","O","O"],
      ["X","X","O","X","O"]
    ]

    var expected = [
      ["O","X","X","O","X"],
      ["X","X","X","X","O"],
      ["X","X","X","X","X"],
      ["O","X","O","O","O"],
      ["X","X","O","X","O"]
    ]

    var output = [
      ["O","X","X","O","X"],
      ["X","X","X","X","O"],
      ["X","X","X","O","X"],
      ["O","X","O","O","O"],
      ["X","X","O","X","O"]
    ]

    console.log(solve(input));
    </script>
    
  
</body>
</html>
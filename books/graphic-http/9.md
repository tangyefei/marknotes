
# 第9章 基于HTTP的功能追加协议

HTTP协议最初创立是当做传输HTML文档的协议，但随着Web应用的功能多样性变化，协议本身存在的限制就开始非常明显，但是因为Web浏览器的使用环境已经遍及全球，因此无法完全抛弃HTTP。可以通过Web应用和脚本程序来满足使用需要，也可以根据HTTP定义新的协议规则。

HTTP的瓶颈主要体现在：
- 一条连接上只可发送一个请求。请求只能从客户端开始。
- 客户端不可以接收除响应以外的指令。
- 请求/响应首部未经压缩就发送。首部信息越多延迟越大。
- 发送冗长的首部。每次互相发送相同的首部造成的浪费较多。
- 可任意选择数据压缩格式。非强制压缩发送。

**Ajax**

利用JavaScript和DOM达到局部页面加载替换的技术手段

**Comet**

一旦服务端内容有更新，不会让客户端等待，而是直接给客户端返回响应

**Spedy**

Google在2010年发布的Spedy是为了解决HTTP的性能瓶颈的协议。它尝试在协议级别消除HTTP所遇到的瓶颈。关于它的设计（因为完全没有听闻到使用热度，怀疑都是被废弃的技术了），感兴趣可以参考该书的对应章节。

**双工通信Websocket**

Websocket协议是基于HTTP建立的协议，建立连接的仍是客户端，一旦建立连接，任何一段都可以直接向对方发送报文。特点有：
- 支持服务端直接向客户端推送数据的功能
- 首部信息很小，通信量相应减少

实现Websocket通信需要在发给服务器的首部字段中带上Upgrade: websocket，告知服务器通信协议发生改变。在握手/请求时，请求首部带上Sec-WebSocket-Key当键值，响应首部中返回101 witching Protocols的响应表示成功，并带上Sec-Websocket-Key的字段值（基于Sec-WebSocket-Key生成）。成功握手建立连接以后，不再使用HTTP的数据帧，而是采用Websocket独立的数据帧。JavaScript可以调用“The Websocket API”以实现在Websocket协议下进行双工通信。

**HTTP2.0**

目标是改善用户在使用Web时的体验，是属于改善Web性能的大杀器，只是什么时候广泛使用仍旧是未知，感兴趣可以单独再查询资料。

**WebDAV**

是一个可直接对Web服务器上内容进行直接复制、编辑等操作的分布式文件系统。

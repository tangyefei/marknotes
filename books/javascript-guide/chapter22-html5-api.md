# JavaScript权威指南-第6版

# 第二部分

# 第22章 HTML5 API

## 跨域消息传递

尽管脚本可以引用其他的Window对象，但是因为内容来自不同的源，浏览器不会允许访问其他窗口中的文档内容 或 调用其他窗口的方法。

HTML5标准中定义了postMessage()方法，允许在不同源的脚本之间，进行有限的通信。

postMessage()方法有两个参数，第一个可以是任何基本类型值 或者 可复制对象（参加22.2节），有些浏览器中只支持字符串，因此要想传递对象或数组，最好先调用JSON.stringify()方法进行序列化。

第二个参数是用于指定目标窗口的字符串，其中包括协议、主机和URL端口部分（除此之外的多余信息会被忽略），也可以使用”*“通配符来表示任何窗口，如果指定要和当前窗口同源的话可以使用”/”。

指定的源匹配的话，目标窗口的Window对象上回触发message事件，事件的接收参数中包含如下属性：

- data，消息内容副本
- source，消息源自的Window对象























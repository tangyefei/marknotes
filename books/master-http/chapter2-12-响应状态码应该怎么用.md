# 12 响应状态码应该怎么用？

本节会介绍状态码的分类和常见状态码的含义，并引导你思考如何做出对应的处理。

响应包含响应头和响应体，响应头又包含了状态行、首部字段，

状态行包含了版本信息、状态码、原因短语，版本通常是HTTP/1.1或HTTP/2，原因短语通常是状态码的简短描述提供信息有限，重点在状态码。


## 状态码分类

状态码是三位数，可以取值从000-999，但是设计成了5类，具体含义是：

1xx：提示信息，表示当前是处理的中间状态，还需要后续的操作
2xx：成功，报文已经被服务器收到并被正确处理
3xx：重定向，资源位置发生变动，需要用户重新请求资源
4xx：客户端错误，请求报文有错误，服务端无法处理
5xx：服务器错误，服务器在处理请求时发生了内部错误



理解状态码是客户端和服务器共同的责任，客户端需要根据状态码做出正而却的后续处理，服务端需要选择最恰当的状态码返回给客户端。

RFC标准里共有41个状态码，但定义是开放的，狠毒服务器都自定义了一些专有的状态码。  

## 比较有价值的状态码

### 1xx

设计用到的很好，偶尔见到 101  Switching Protocols，意思是客户端使用Upgarde头字段，要求在HTTP协议的基础上改成其他协议继续通信。比如Websocket，如果服务器统一变更，就胡发送状态码101，后面的传输就不会再使用HTTP。

### 2xx

200 OK，最常见的成功状态码。

204 No Content，含义和200基本相同，但响应后没有body数据。

206 Partical Content，分快下载后断点续传的基础，body里的资源只是最终要获取的完整资源的一部分。通常伴随Content-Range。

### 3xx

301 Move Permanently，表示资源被永久重定向，需要改用新的URI访问

302 Found，Moved Temporarily，资源还在，暂时需要用另一个URI访问。

301 302都会在响应头中用Location指明要后续跳转的URI。

场景可以举个例子：http升级到https，所有到http的请求都要被重定向到新的https的地址，状态返回301；服务器暂时升级，先访问一个临时静态页面用于告知用户，这里就是和用302.


304 Not Modified，用于协商缓存中结合If-Modified-Since使用，如果发现资源为更改，可以直接使用本地缓存。

### 4xx


400 Bad Request，客户端发送的请求报文有错误，它只是一个笼统的错误，服务端应该使用有更明确含义的状态码。

401 Unauthorized，请求未授权，需要携带必要的标志才能访问资源

403 Forbidden，实际上不是客户端错误，服务器禁止访问资源，服务器友好一些会在body练给到具体原因（虽然现实通常什么都不给）。

404 Not Found，资源在服务器为找到，所以无安抚提供给客户端。

405 Method Not Allowed,不用需使用某些方法操作某些资源。

### 5xx

500 Internal Serever Eerror，和400类似是一个很通用的状态码，不过对于不希望暴露太多信息给客户端的服务器而言是件好事

501 Not Implement，即将开业，敬请期待的意思

502 Bad Gateway，服务器作为网管或者代理时候返回，表示该服务器自身正常，但访问后端服务器时发生错误，具体原因不知。

503 Service Unavailable，服务器很忙暂时无法响应，通常还会有一个Retry-After字段告知稍后重试的时间。










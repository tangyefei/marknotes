# 计算机网络应该掌握的基础知识

**OSI(Open System Interconnection model)**

是国际标准化组织提出的概念模型。它将计算机网络体系结构划分为七层。


互联网的实际工业标准是TCP/IP 协议。


![1156719-afc57efbe98be4f6](./1156719-afc57efbe98be4f6.png)

**从上到下的解释和用途：**

- 应用层，直接为应用提供服务，包括 HTTP协议、DNS、SMTP协议、FTP协议等
- 表示层，将应用层的数据进行合理的表示，包括编码、数据转换、加密解密等。
- 会话层，提供表示层的建立和使用连接的方法，组织和协调会话进程间的通信。
- 运输层，确保两个节点的数据的可靠传达，必要时对数据进行分割，将数据传输到网络层。
- 网络层，通过算法，为报文选择合适的路径。
- 数据链路层，将有差错的物理信道变为无差错的、能可靠传输数据帧的数据链路。
- 物理层，使用传输介质提供物理连接，将信息编码成电流脉冲或其他信号实现传输。

**TCP/IP协议**

它没有照搬OSI模型，将一些层的功能整合在一起，通常划分为三到五层。这里介绍的是四层的分法：

- 应用层，对应OSI的应用层和表示层
- 传输层，对应OSI的传输层，提供TCP/UDP这两种端到端的通信服务。
- 网际层，对应OSI的网络层，包含IP协议等
- 网络接口层，实现数据在网络介质上传输的协议。


如下为在四层协议上传输数据包的示意图：

![1156719-d9684a2e160f62ad](./1156719-d9684a2e160f62ad.png)

**浏览器中输入网址的过程**

1. 应用层，DNS会将网址解析成IP地址，然后给Web服务器发送HTTP请求
2. 传输层，将HTTP数据包嵌入在TCP的报文中，报文由TCP首部+HTTP数据包组成
3. 网络层， TCP报文嵌入IP数包中，由IP地址信息+TCP报文组成
4. 网络接口层，IP数据包嵌入到数据帧中，并在网络上传送
5. 数据包经过多个网关传送，到达对一个网站的服务器，请求对应端口服务
6. 请求处理完成后，服务器返回HTTP响应
7. 浏览器再按照4-3-2-1的过程读取到HTTP响应，并且呈现给用户

**TCP/UDP**



TCP（Transmission Control Protocol，传输控制协议）

提供的是基于连接，可靠的字节流服务。

即客户和服务器交换数据前，必须现在双方之间建立一个TCP连接，之后才能传输数据。并且提供超时重发，丢弃重复数据，检验数据，流量控制等功能，保证数据能从一端传到另一端。


UDP（User Data Protocol，用户数据报协议）

不提供可靠性，只是把应用程序传给IP层的数据报发送出去，但是不能保证它们能到达目的地。

传输数据包前不用在客户和服务器之间建立连接，且没有超时重发等机制，所以传输速度很快。


他们的差异总结为：

- TCP面向连接；UDP是无连接。
- TCP提供无差错/不丢失/不重复/按序到达的服务；UDP尽最大努力交付，单不保证可靠。
- TCP传输数据被当做无结构的字节流；UDP是面向报文，另网络拥塞不会使主机发送速率降低。
- TCP连接只能是点到点的；UDP支持一对一，一对多，多对一，多对多。
- TCP首部开销20字节；UDP的首部开销8个字节。
- TCP的逻辑通信信道是全双工的可靠信道；UDP则是不可靠信道。

**TCP三次握手/四次分手**

因为信道不可靠, 但是通信双发需要就某个问题达成一致. 三次通信是解决这个问题理论上的最小值。

注：SYN(synchronous建立联机)和ACK(acknowledgement确认)是TCP传输过程的标志位

三次握手的描述：

1. 客户端发送SYN包到服务器，等待服务器确认接收。
2. 服务器确认接收SYN包并确认客户的SYN，并发送回来一个SYN+ACK的包给客户端。
3. 客户端确认接收服务器的SYN+ACK包，并向服务器发送确认包ACK，二者相互建立联系后，完成tcp三次握手。


**参考资料：**

- 能更深入 [通俗大白话来理解TCP协议的三次握手和四次分手](https://github.com/jawil/blog/issues/14)
- 有些价值 [计算机网络 —— 网络分层架构](https://chenjiayang.me/2017/07/28/sth-about-network/)
- 有些价值 [深入浅出－网络七层模型&&网络数据包](https://www.jianshu.com/p/4b9d43c0571a)
